using UnityEngine;
using UnityEngine.EventSystems; // UI ì´ë²¤íŠ¸ ì²˜ë¦¬ë¥¼ ìœ„í•´ ì—¬ì „íˆ í•„ìš”í•©ë‹ˆë‹¤.

public class SettingsManager : MonoBehaviour
{
    // ğŸ’¡ Inspector ì°½ì—ì„œ SettingsPanel GameObjectë¥¼ ì—°ê²°í•´ ì£¼ì„¸ìš”.
    public GameObject settingsPanel;
    
    // ğŸ’¡ ìŠ¬ë¼ì´ë” ì¡°ì‘ ì¤‘ì¸ì§€ ìƒíƒœë¥¼ ê¸°ë¡í•  ë³€ìˆ˜ (ì´ì „ ë°©ì‹)
    private bool isDraggingSlider = false; 

    // =======================================================
    // ğŸš¨ ë§ˆìš°ìŠ¤ ì…ë ¥ ê°ì§€ ë° íŒ¨ë„ ë‹«ê¸° ë¡œì§ (ê°„ì†Œí™”)
    // =======================================================
    
    void Update()
    {
        // 1. ì„¤ì • íŒ¨ë„ì´ í™œì„±í™”ë˜ì–´ ìˆê³ ,
        // 2. í˜„ì¬ ìŠ¬ë¼ì´ë”ë¥¼ ë“œë˜ê·¸í•˜ê³  ìˆì§€ ì•Šì„ ë•Œë§Œ
        // 3. ë§ˆìš°ìŠ¤ ì™¼ìª½ ë²„íŠ¼ì„ ë—€ ì´ë²¤íŠ¸ë¥¼ ê°ì§€í•©ë‹ˆë‹¤.
        if (settingsPanel.activeSelf && !isDraggingSlider)
        {
            if (Input.GetMouseButtonUp(0))
            {
                // ì´ ì½”ë“œëŠ” 'UI ë°– í´ë¦­'ì„ í™•ì¸í•˜ëŠ” ì½”ë“œë¥¼ ìƒëµí•˜ê³ ,
                // ìŠ¬ë¼ì´ë” ì¡°ì‘ ì¤‘ì´ ì•„ë‹ˆë¼ë©´ ë‹«ë„ë¡ ê°€ì •í•©ë‹ˆë‹¤.
                
                // ë§Œì•½ ì´ ìœ„ì¹˜ì—ì„œ ë‹«íˆëŠ” ê²ƒì´ ë¬¸ì œë¼ë©´, ì•„ë˜ ì½”ë“œë¥¼ í™œì„±í™”í•˜ì„¸ìš”.
                // if (!IsPointerOverUIObject()) { CloseSettings(); } 
                // í•˜ì§€ë§Œ ì¼ë‹¨ì€ ê°€ì¥ ê°„ë‹¨í•œ ë°©ë²•ìœ¼ë¡œ ì‹œë„í•©ë‹ˆë‹¤.

                // ì„ì‹œë¡œ CloseSettings() í˜¸ì¶œì„ ë§‰ê³  í…ŒìŠ¤íŠ¸í•©ë‹ˆë‹¤.
                // CloseSettings(); 
            }
        }
    }
    
    // ğŸ’¡ ìŠ¬ë¼ì´ë”ì— ì—°ê²°í•  í•¨ìˆ˜ë“¤: ë“œë˜ê·¸ ì‹œì‘/ì¢…ë£Œ ì‹œ í˜¸ì¶œë©ë‹ˆë‹¤.
    // **ìŠ¬ë¼ì´ë” ì˜¤ë¸Œì íŠ¸ì— ì´ í•¨ìˆ˜ë“¤ì„ ì—°ê²°í•´ì•¼ í•©ë‹ˆë‹¤.**

    // ë“œë˜ê·¸ë¥¼ ì‹œì‘í•  ë•Œ (ë§ˆìš°ìŠ¤ê°€ ìŠ¬ë¼ì´ë”ë¥¼ ëˆŒë €ì„ ë•Œ)
    public void StartSliderDrag()
    {
        isDraggingSlider = true;
    }

    // ë“œë˜ê·¸ë¥¼ ëë‚¼ ë•Œ (ë§ˆìš°ìŠ¤ê°€ ìŠ¬ë¼ì´ë”ì—ì„œ ë²„íŠ¼ì„ ë—„ ë•Œ)
    public void EndSliderDrag()
    {
        isDraggingSlider = false;
    }
    
    // =======================================================
    // íŒ¨ë„ ì—´ê¸°/ë‹«ê¸° í•¨ìˆ˜
    // =======================================================

    // ì„¤ì •ì°½ì„ ë„ìš°ëŠ” í•¨ìˆ˜
    public void OpenSettings()
    {
        settingsPanel.SetActive(true);
    }

    // ì„¤ì •ì°½ì„ ë‹«ëŠ” í•¨ìˆ˜
    public void CloseSettings()
    {
        settingsPanel.SetActive(false);
    }
}